<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/login.css">
  <title>PetShop Innovador - Iniciar Sesión</title>
</head>
<body>
  <%- include('partials/header', { page: 'login' }) %>
  
  <main class="login-main">
    <div class="login-container">
      <!-- Left Side - Login Form -->
      <div class="login-form-section" data-aos="fade-right">
        <div class="form-header">
          <h1 class="form-title">
            <i class="fas fa-paw"></i>
            Iniciar Sesión
          </h1>
          <p class="form-subtitle">Bienvenido de vuelta a PetShop Innovador</p>
        </div>

        <!-- Error Messages -->
        <% if (locals.errors && Object.keys(errors).length > 0) { %>
          <div class="error-container">
            <div class="error-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <ul class="error-list">
              <% for (let error in errors) { %>
                <li><%= errors[error].msg %></li>
              <% } %>
            </ul>
          </div>
        <% } %>

        <form action="/users/login" method="POST" class="login-form" novalidate>
          <% if (locals.redirectUrl) { %>
            <input type="hidden" name="redirectUrl" value="<%= redirectUrl %>">
          <% } %>
          
          <div class="form-group">
            <label for="email" class="form-label">
              <i class="fas fa-envelope"></i>
              Correo Electrónico
            </label>
            <div class="input-wrapper">
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="form-input <%= (locals.errors && errors.email) ? 'error' : '' %>"
                placeholder="tu@email.com"
                value="<%= locals.oldData ? oldData.email : '' %>"
                required
              >
              <div class="input-icon">
                <i class="fas fa-envelope"></i>
              </div>
            </div>
            <% if (locals.errors && errors.email) { %>
              <div class="field-error">
                <i class="fas fa-exclamation-circle"></i>
                <%= errors.email.msg %>
              </div>
            <% } %>
          </div>

          <div class="form-group">
            <label for="contraseña" class="form-label">
              <i class="fas fa-lock"></i>
              Contraseña
            </label>
            <div class="input-wrapper">
              <input 
                type="password" 
                id="contraseña" 
                name="contraseña" 
                class="form-input <%= (locals.errors && errors.contraseña) ? 'error' : '' %>"
                placeholder="Tu contraseña"
                required
              >
              <div class="input-icon">
                <i class="fas fa-lock"></i>
              </div>
              <button type="button" class="password-toggle" id="togglePassword">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            <% if (locals.errors && errors.contraseña) { %>
              <div class="field-error">
                <i class="fas fa-exclamation-circle"></i>
                <%= errors.contraseña.msg %>
              </div>
            <% } %>
          </div>

          <div class="form-options">
            <label class="checkbox-container">
              <input type="checkbox" name="remember" id="remember">
              <span class="checkmark"></span>
              Recordarme
            </label>
            <a href="/users/forgot-password" class="forgot-link">
              ¿Olvidaste tu contraseña?
            </a>
          </div>

          <button type="submit" class="btn btn-primary btn-large">
            <i class="fas fa-sign-in-alt"></i>
            Iniciar Sesión
          </button>

          <div class="form-divider">
            <span>o</span>
          </div>

          <div class="auth-links">
            <p>¿No tienes cuenta?</p>
            <a href="/users/registro" class="btn btn-outline">
              <i class="fas fa-user-plus"></i>
              Crear Cuenta
            </a>
          </div>
        </form>

        <!-- Quick Login for Development -->
        <div class="quick-login" style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #ffc107;">
          <h4 style="color: #856404; margin-bottom: 15px;">
            <i class="fas fa-tools"></i>
            Acceso Rápido (Desarrollo)
          </h4>
          <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <button type="button" class="btn-quick-login" data-email="admin@petshop.com" data-password="admin123">
              <i class="fas fa-user-shield"></i>
              Admin
            </button>
            <button type="button" class="btn-quick-login" data-email="cliente@test.com" data-password="cliente123">
              <i class="fas fa-user"></i>
              Cliente
            </button>
          </div>
        </div>
      </div>

      <!-- Right Side - Image/Info -->
      <div class="login-image-section" data-aos="fade-left">
        <div class="image-content">
          <div class="image-overlay">
            <h2>¡Tu mascota te está esperando!</h2>
            <p>Descubre los mejores productos para el cuidado y felicidad de tu compañero peludo.</p>
            <div class="features-list">
              <div class="feature">
                <i class="fas fa-heart"></i>
                <span>Productos de calidad premium</span>
              </div>
              <div class="feature">
                <i class="fas fa-shipping-fast"></i>
                <span>Envío gratis en compras +$50.000</span>
              </div>
              <div class="feature">
                <i class="fas fa-medal"></i>
                <span>Garantía de satisfacción</span>
              </div>
            </div>
          </div>
          <img src="https://images.unsplash.com/photo-1601758228041-f3b2795255f1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80" alt="Mascota feliz" />
        </div>
      </div>
    </div>
  </main>

  <%- include('partials/footer') %>

  <!-- Scripts -->
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="/js/loginValidations.js"></script>
  <script>
    // Initialize AOS
    AOS.init({
      duration: 800,
      easing: 'ease-in-out',
      once: true
    });

    // Password toggle
    document.getElementById('togglePassword').addEventListener('click', function() {
      const passwordInput = document.getElementById('contraseña');
      const icon = this.querySelector('i');
      
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        passwordInput.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    });

    // Quick login functionality
    document.querySelectorAll('.btn-quick-login').forEach(button => {
      button.addEventListener('click', function() {
        const email = this.dataset.email;
        const password = this.dataset.password;
        
        document.getElementById('email').value = email;
        document.getElementById('contraseña').value = password;
        
        // Optional: Auto-submit after a short delay
        setTimeout(() => {
          document.querySelector('.login-form').submit();
        }, 500);
      });
    });

    // Form validation feedback
    document.querySelectorAll('.form-input').forEach(input => {
      input.addEventListener('blur', function() {
        if (this.value.trim() !== '') {
          this.classList.add('filled');
        } else {
          this.classList.remove('filled');
        }
      });

      input.addEventListener('focus', function() {
        this.parentElement.classList.add('focused');
      });

      input.addEventListener('blur', function() {
        this.parentElement.classList.remove('focused');
      });
    });
  </script>
</body>
</html>