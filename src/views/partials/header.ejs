<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/footer.css">
  <link rel="stylesheet" href="/css/animations.css">
  <% if (typeof page !== 'undefined' && page === 'home') { %>
    <link rel="stylesheet" href="/css/home.css">
    <title>🐾 PetShop Innovador - Todo para tu mascota</title>
  <% } else if (typeof page !== 'undefined' && page === 'detail') { %>
    <link rel="stylesheet" href="/css/detail.css">
    <title>PetShop Innovador - Detalle del Producto</title>
  <% } else if (typeof page !== 'undefined' && page === 'productos') { %>
    <link rel="stylesheet" href="/css/productos.css">
    <title>PetShop Innovador - Productos</title>
  <% } else if (typeof page !== 'undefined' && page === 'carrito') { %>
    <link rel="stylesheet" href="/css/carrito.css">
    <title>PetShop Innovador - Carrito de Compras</title>
  <% } else if (typeof page !== 'undefined' && page === 'login') { %>
    <link rel="stylesheet" href="/css/login.css">
    <title>PetShop Innovador - Iniciar Sesión</title>
  <% } else if (typeof page !== 'undefined' && page === 'registro') { %>
    <link rel="stylesheet" href="/css/registro.css">
    <title>PetShop Innovador - Crear Cuenta</title>
  <% } else if (typeof page !== 'undefined' && page === 'profile') { %>
    <title>🐾 PetShop Innovador - Mi Perfil</title>
  <% } else { %>
    <title>PetShop Innovador</title>
  <% } %>
  
  <!-- Variables globales para JavaScript -->
  <script>
    window.petshopConfig = {
      isLoggedIn: <%= locals.isLoggedIn ? 'true' : 'false' %>,
      userInfo: {
        <% if (locals.isLoggedIn && locals.userLogged) { %>
          firstName: '<%= userLogged.firstName %>',
          email: '<%= userLogged.email %>',
          category: '<%= userLogged.category %>'
        <% } else { %>
          firstName: null,
          email: null,
          category: null
        <% } %>
      }
    };
  </script>
</head>
<body>

<!-- Header Principal Responsivo -->
<header class="main-header">
  <div class="header-container">
    <!-- Logo -->
    <div class="logo-section">
      <a href="/" class="logo-link">
        <img src="/images/logo_petshop.jpeg" alt="PetShop Innovador" class="logo-img">
        <span class="logo-text">PetShop Innovador</span>
      </a>
    </div>

    <!-- Navegación Principal (Desktop) -->
    <nav class="main-nav desktop-nav">
      <ul class="nav-list">
        <!-- Dropdown Perros -->
        <li class="dropdown">
          <a href="/productos/categoria/perros" class="nav-link dropdown-toggle">
            <i class="fas fa-dog"></i> Perros
          </a>
          <ul class="dropdown-menu">
            <li><a href="/productos/categoria/perros/alimentos"><i class="fas fa-utensils"></i> Alimentos</a></li>
            <li><a href="/productos/categoria/perros/accesorios"><i class="fas fa-bone"></i> Accesorios</a></li>
            <li><a href="/productos/categoria/perros/higiene-y-salud"><i class="fas fa-spa"></i> Higiene y Salud</a></li>
            <li><a href="/productos/categoria/perros/juguetes"><i class="fas fa-gamepad"></i> Juguetes</a></li>
            <li><a href="/productos/categoria/perros/comodidad"><i class="fas fa-bed"></i> Comodidad</a></li>
          </ul>
        </li>
        
        <!-- Dropdown Gatos -->
        <li class="dropdown">
          <a href="/productos/categoria/gatos" class="nav-link dropdown-toggle">
            <i class="fas fa-cat"></i> Gatos
          </a>
          <ul class="dropdown-menu">
            <li><a href="/productos/categoria/gatos/alimentos"><i class="fas fa-utensils"></i> Alimentos</a></li>
            <li><a href="/productos/categoria/gatos/accesorios"><i class="fas fa-bone"></i> Accesorios</a></li>
            <li><a href="/productos/categoria/gatos/higiene-y-salud"><i class="fas fa-spa"></i> Higiene y Salud</a></li>
            <li><a href="/productos/categoria/gatos/juguetes"><i class="fas fa-gamepad"></i> Juguetes</a></li>
            <li><a href="/productos/categoria/gatos/comodidad"><i class="fas fa-bed"></i> Comodidad</a></li>
          </ul>
        </li>
        
        <!-- Dropdown Aves -->
        <li class="dropdown">
          <a href="/productos/categoria/aves" class="nav-link dropdown-toggle">
            <i class="fas fa-dove"></i> Aves
          </a>
          <ul class="dropdown-menu">
            <li><a href="/productos/categoria/aves/alimentos"><i class="fas fa-utensils"></i> Alimentos</a></li>
            <li><a href="/productos/categoria/aves/accesorios"><i class="fas fa-home"></i> Accesorios</a></li>
            <li><a href="/productos/categoria/aves/higiene-y-salud"><i class="fas fa-spa"></i> Higiene y Salud</a></li>
            <li><a href="/productos/categoria/aves/juguetes"><i class="fas fa-gamepad"></i> Juguetes</a></li>
          </ul>
        </li>
        
        <!-- Dropdown Peces -->
        <li class="dropdown">
          <a href="/productos/categoria/peces" class="nav-link dropdown-toggle">
            <i class="fas fa-fish"></i> Peces
          </a>
          <ul class="dropdown-menu">
            <li><a href="/productos/categoria/peces/alimentos"><i class="fas fa-utensils"></i> Alimentos</a></li>
            <li><a href="/productos/categoria/peces/accesorios"><i class="fas fa-water"></i> Accesorios</a></li>
            <li><a href="/productos/categoria/peces/higiene-y-salud"><i class="fas fa-spa"></i> Higiene y Salud</a></li>
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Iconos de Usuario y Carrito -->
    <div class="header-actions">
      <% if (locals.isLoggedIn) { %>
        <div class="user-menu">
          <div class="user-info">
            <span class="user-greeting">Hola, <%= userLogged.firstName %>!</span>
            <% if (userLogged.category === 'Administrador') { %>
              <span class="admin-badge">Admin</span>
            <% } %>
          </div>
          <div class="user-actions">
            <% if (userLogged.category === 'Administrador') { %>
              <a href="/admin/dashboard" title="Panel de Administración" class="header-icon admin-icon">
                <i class="fas fa-tachometer-alt"></i>
              </a>
            <% } %>
            <a href="/users/profile" title="Mi Perfil" class="header-icon">
              <i class="fas fa-user"></i>
            </a>
            <a href="/users/logout" title="Cerrar Sesión" class="header-icon logout-icon">
              <i class="fas fa-sign-out-alt"></i>
            </a>
          </div>
        </div>
      <% } else { %>
        <div class="auth-links">
          <a href="/users/login" class="header-icon login-btn" title="Iniciar Sesión">
            <i class="fas fa-sign-in-alt"></i>
            <span>Ingresar</span>
          </a>
          <a href="/users/registro" class="header-icon register-btn" title="Registrarse">
            <i class="fas fa-user-plus"></i>
            <span>Registro</span>
          </a>
        </div>
      <% } %>
      
      <!-- Carrito -->
      <a href="/carrito" title="Carrito de Compras" class="header-icon cart-icon">
        <i class="fas fa-shopping-cart"></i>
        <span class="cart-badge" style="display: none;">0</span>
      </a>
    </div>

    <!-- Botón Menu Mobile -->
    <button class="mobile-menu-btn" id="mobile-menu-btn">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
  </div>

  <!-- Menu Mobile -->
  <nav class="mobile-nav" id="mobile-nav">
    <ul class="mobile-nav-list">
      <li><a href="/productos/categoria/perros" class="mobile-nav-link"><i class="fas fa-dog"></i> Perros</a></li>
      <li><a href="/productos/categoria/gatos" class="mobile-nav-link"><i class="fas fa-cat"></i> Gatos</a></li>
      <li><a href="/productos/categoria/aves" class="mobile-nav-link"><i class="fas fa-dove"></i> Aves</a></li>
      <li><a href="/productos/categoria/peces" class="mobile-nav-link"><i class="fas fa-fish"></i> Peces</a></li>
      
      <% if (locals.isLoggedIn) { %>
        <li class="mobile-user-section">
          <div class="mobile-user-info">
            <span>Hola, <%= userLogged.firstName %>!</span>
            <% if (userLogged.category === 'Administrador') { %>
              <span class="admin-badge">Admin</span>
            <% } %>
          </div>
        </li>
        <% if (userLogged.category === 'Administrador') { %>
          <li><a href="/admin/dashboard" class="mobile-nav-link admin-link"><i class="fas fa-tachometer-alt"></i> Panel Admin</a></li>
        <% } %>
        <li><a href="/users/profile" class="mobile-nav-link"><i class="fas fa-user"></i> Mi Perfil</a></li>
        <li><a href="/users/logout" class="mobile-nav-link logout-link"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a></li>
      <% } else { %>
        <li><a href="/users/login" class="mobile-nav-link"><i class="fas fa-sign-in-alt"></i> Iniciar Sesión</a></li>
        <li><a href="/users/registro" class="mobile-nav-link"><i class="fas fa-user-plus"></i> Registrarse</a></li>
      <% } %>
    </ul>
  </nav>
</header>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const mobileMenuBtn = document.getElementById('mobile-menu-btn');
  const mobileNav = document.getElementById('mobile-nav');
  let isMenuOpen = false;

  mobileMenuBtn.addEventListener('click', function() {
    isMenuOpen = !isMenuOpen;
    mobileNav.classList.toggle('active', isMenuOpen);
    mobileMenuBtn.classList.toggle('active', isMenuOpen);
    document.body.classList.toggle('menu-open', isMenuOpen);
  });

  // Cerrar menu al hacer click fuera
  document.addEventListener('click', function(e) {
    if (isMenuOpen && !mobileNav.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
      isMenuOpen = false;
      mobileNav.classList.remove('active');
      mobileMenuBtn.classList.remove('active');
      document.body.classList.remove('menu-open');
    }
  });

  // Cerrar menu al cambiar de página
  window.addEventListener('beforeunload', function() {
    mobileNav.classList.remove('active');
    mobileMenuBtn.classList.remove('active');
    document.body.classList.remove('menu-open');
  });
});
</script>

<!-- Script para actualizar contador de carrito en todas las páginas -->
<script>
// Función para actualizar contador del carrito (versión simplificada para header)
function actualizarContadorCarrito() {
    const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
    const contador = carrito.reduce((total, item) => total + item.cantidad, 0);
    
    // Buscar elementos del contador en el header
    const contadores = document.querySelectorAll('.cart-count, .cart-badge, .carrito-count, [data-cart-count]');
    contadores.forEach(element => {
        element.textContent = contador;
        element.style.display = contador > 0 ? 'flex' : 'none';
    });
}

// Actualizar contador cuando se carga la página
document.addEventListener('DOMContentLoaded', function() {
    actualizarContadorCarrito();
});

// Escuchar cambios en localStorage para actualizar contador en tiempo real
window.addEventListener('storage', function(e) {
    if (e.key === 'carrito') {
        actualizarContadorCarrito();
    }
});
</script>

</header>

<!-- Incluir Hero Banner solo en páginas de productos -->
<% if (typeof page !== 'undefined' && (page === 'productos' || page === 'detail' || page === 'producto')) { %>
  <%- include('hero-banner') %>
<% } %>